<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="favicon.ico" href="img/favicon.ico">
  <title>Iniciar sesión | Adóptame</title>
  <link href="css/styles.css" rel="stylesheet" />
</head>

<!-- Encabezado principal -->
<body class="bg-main-light0 text-main-dark flex flex-col min-h-screen">
  <header class="bg-main-light0 shadow-md fixed top-0 left-0 w-full z-50 ">
    <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 ">
      <div class="flex justify-between items-center h-16">

        <!-- Menú para escritorio -->
        <div class="flex items-center justify-between w-full px-6">
          <!-- Logo alineado a la izquierda -->
          <div class="flex items-center">
            <img src="img/logo.png" alt="Logo" class="h-10 w-auto mr-2">
            <a href="index.html" class="text-3xl font-bold text-main-fuchsia font-main-quicksand ">Adóptame</a>
          </div>

          <nav class="hidden md:flex flex-grow justify-evenly text-main-dark max-w-[600px]">
            <a href="adoptar.html" class="font-bold hover:text-main-fuchsia font-main-quicksand px-2 py-2 ">Adoptar</a>
            <a href="contacto.html"
              class="font-bold hover:text-main-fuchsia font-main-quicksand px-2 py-2 ">Contacto</a>
            <!-- Las líneas comentadas corresponden al botón con el Active maquetado -->
            <!-- <a href="#"
                          class="font-bold bg-main-pink px-2 py-2 rounded-md font-main-quicksand hover:text-main-fuchsia">Contacto</a> -->
            <!-- <a href="./adoptar.html"
                          class="font-bold bg-main-pink px-2 py-2 rounded-md font-main-quicksand hover:text-main-fuchsia">Adoptar</a> -->
            <a href="informacion.html" class="font-bold hover:text-main-fuchsia font-main-quicksand px-2 py-2">Más
              Información</a>
            <!-- <a href="#"
                          class="font-bold bg-main-pink px-2 py-2 rounded-md font-main-quicksand hover:text-main-fuchsia">Más Información</a> -->
          </nav>

          <!-- Ícono de usuario alineado a la derecha -->
          <div class="hidden md:flex">
            <a href="login.html"><img src="img/user.png" alt="Usuario" class="h-12 w-auto"></a>
          </div>
        </div>

        <!-- Menú hamburguesa  -->
        <div class="md:hidden relative w-full flex justify-end">
          <!-- Checkbox oculto para manejar el menú -->
          <input type="checkbox" id="menu-toggle" class="peer hidden">

          <!-- Botón hamburguesa alineado a la derecha -->
          <label for="menu-toggle" class="cursor-pointer">
            <img src="img/menu-hamburger.png" alt="Menú" class="h-10 w-10">
          </label>

          <!-- Menú desplegable en móviles -->
          <div#
            class="absolute top-full right-[-8%] w-[240%] bg-main-light0 shadow-md hidden peer-checked:flex flex-col items-end mt-3 pb-3">
            <a href="adoptar.html"
              class="block font-main-quicksand font-bold py-2 px-4 text-right hover:text-main-fuchsia">Adoptar</a>
            <a href="contacto.html"
              class="block font-main-quicksand font-bold py-2 px-4 text-right hover:text-main-fuchsia">Contacto</a>
            <!-- SELECTED <a href="#"
                          class="block text-main-dark font-bold bg-main-pink text-right px-4 py-2 rounded-md font-main-quicksand hover:text-main-fuchsia">Contacto</a> -->
            <a href="informacion.html"
              class="block font-main-quicksand font-bold py-2 px-4 text-right hover:text-main-fuchsia">Más
              Información</a>
            <a href="login.html"
              class="block text-main-dark font-bold bg-main-pink text-right px-4 py-2 rounded-md font-main-quicksand hover:text-main-fuchsia">Iniciar
              sesión</a>
          </div#>

        </div>

      </div>
    </nav>
  </header>

  <!-- Contenido principal -->
  <main class="items-center text-center font-main-barlow">

    <section class="bg-main-light1 w-11/12 max-w-lg mx-auto mb-8 mt-24 p-8 rounded-lg">

      <!-- Título -->
      <h1 class="font-main-quicksand font-semibold text-2xl lg:text-3xl">
        Inicio de sesión
      </h1>

      <!-- Formulario -->
      <form id="loginForm" class="mt-6 w-4/5 mx-auto text-left">
        <!-- Campo de Email -->
        <div class="mb-4">
          <label for="email" class="block font-main-quicksand mb-1 text-main-dark">
            Email:
          </label>
          <input type="email" id="email" name="email" required placeholder="Ingresa tu correo"
            class="border bg-main-white border-main-fuchsia w-full p-2 rounded-lg focus:outline-none focus:border-main-green" />
        </div>

        <!-- Campo de Contraseña -->
        <div class="mb-4">
          <label for="password" class="block font-main-quicksand mb-1 text-main-dark">
            Contraseña:
          </label>
          <input type="password" id="password" name="password" required placeholder="Ingresa tu contraseña"
            minlength="5" maxlength="16"
            class="border bg-main-white border-main-fuchsia w-full p-2 rounded-lg focus:outline-none focus:border-main-green" />
        </div>

        <!-- Enlace "¿Olvidaste tu contraseña?" -->
        <div class="flex justify-end mb-4">
          <a href="#" class="text-sm text-main-fuchsia hover:underline">
            ¿Olvidaste tu contraseña?
          </a>
        </div>

        <!-- Botón de inicio de sesión -->
        <div class="flex justify-center">
          <button type="submit"
            class="bg-main-green font-main-quicksand h-11 w-42 rounded-lg font-bold hover:bg-main-lightgreen transition text-xl cursor-pointer">
            Iniciar Sesión
          </button>
        </div>
      </form>

      <!-- Enlace para crear cuenta -->
      <p class="mt-4 text-sm">
        ¿No tienes una cuenta?
        <a href="registro.html" class="text-main-fuchsia hover:underline">Crea cuenta</a>
      </p>
    </section>
  </main>

  <footer class="w-full bg-main-pink py-8 mt-auto text-main-dark text-center">
    <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 text-center sm:text-left">

        <!-- Sobre Nosotros -->
        <div class=" w-[220px] mx-auto">
          <h3
            class="font-semibold text-lg border-b-2 border-main-dark inline-block pb-1 font-main-quicksand text-center">
            Sobre nosotros
          </h3>
          <ul class="mt-3 space-y-2">
            <li><a href="#" class="hover:underline font-main-barlow">Nuestro equipo</a></li>
            <li><a href="#" class="hover:underline font-main-barlow">Nuestros métodos</a></li>
            <li><a href="contacto.html" class="hover:underline font-main-barlow">Contacto</a></li>
          </ul>
        </div>

        <!-- Servicios -->
        <div class="w-[220px] mx-auto">
          <h3
            class="font-semibold text-lg border-b-2 border-main-dark inline-block pb-1 font-main-quicksand  text-center">
            Servicios
          </h3>
          <ul class="mt-3 space-y-2">
            <li><a href="#" class="hover:underline font-main-barlow">Rescate de animales</a></li>
            <li><a href="#" class="hover:underline font-main-barlow">Educación ambiental</a></li>
            <li><a href="#" class="hover:underline font-main-barlow">Voluntariado</a></li>
          </ul>
        </div>

        <!-- Proyectos -->
        <div class="w-[220px] mx-auto">
          <h3
            class="font-semibold text-lg border-b-2 border-main-dark inline-block pb-1 font-main-quicksand text-center">
            Proyectos
          </h3>
          <ul class="mt-3 space-y-2">
            <li><a href="#" class="hover:underline font-main-barlow">Especies en peligro</a></li>
            <li><a href="#" class="hover:underline font-main-barlow">Adopciones responsables</a></li>
            <li><a href="#" class="hover:underline font-main-barlow">Apadrinamiento</a></li>
          </ul>
        </div>

        <!-- Síguenos -->
        <div class="w-[220px] mx-auto">
          <h3 class="font-semibold text-lg border-b-2 border-main-dark inline-block pb-1 font-main-quicksand">
            Síguenos
          </h3>
          <ul class="mt-3 space-y-2">
            <li><a href="#" class="hover:underline font-main-barlow">Nuestro equipo</a></li>
            <li><a href="#" class="hover:underline font-main-barlow">Contenido</a></li>
          </ul>

          <!-- Iconos redes sociales -->
          <div class="mt-2 text-xl space-x-4">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-linkedin"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <!-- Script para manejar el inicio de sesión -->
  <script>
    // Selecciona el formulario
    const formulario = document.querySelector("form");

    // Revisar si hay un mensaje de registro en localStorage
    const mensajeRegistro = localStorage.getItem("mensajeRegistro");

    if (mensajeRegistro) {
        const mensajeDiv = document.createElement("div");
        mensajeDiv.textContent = mensajeRegistro;
        mensajeDiv.style.color = "green";
        mensajeDiv.style.fontSize = "16px";
        mensajeDiv.style.marginBottom = "10px";
        mensajeDiv.style.textAlign = "center";
        mensajeDiv.style.padding = "10px";
        mensajeDiv.style.border = "1px solid green";
        mensajeDiv.style.borderRadius = "5px";
        mensajeDiv.style.backgroundColor = "#e6ffe6";

        // Insertar el mensaje antes del formulario
        formulario.parentNode.insertBefore(mensajeDiv, formulario);

        // Eliminar el mensaje del localStorage después de mostrarlo
        localStorage.removeItem("mensajeRegistro");

        // Hacer que el mensaje desaparezca después de 7 segundos (7000 ms)
        setTimeout(() => {
            mensajeDiv.style.transition = "opacity 1s";
            mensajeDiv.style.opacity = "0";
            setTimeout(() => mensajeDiv.remove(), 1000);
        }, 7000);
    }

    // Manejo del formulario de login
    formulario.addEventListener("submit", async (evento) => {
        evento.preventDefault();

        const formData = new FormData(formulario);
        const data = {
            email: formData.get("email"),
            password: formData.get("password"),
        };

        try {
            // Enviar los datos al servidor mediante POST
            const response = await fetch("http://localhost:3000/login", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
            });

            console.log("Status de la respuesta:", response.status);
            const result = await response.json();

            console.log("Respuesta del servidor:", result);

            if (response.ok) {
                // Guardar el usuario en localStorage
                localStorage.setItem("usuario", JSON.stringify(result.usuario));
                formulario.reset();
                window.location.href = "index.html"; // Redirige al usuario a la página principal
            } else {
                alert(result.mensaje);
            }
        } catch (error) {
            console.error("Error en la solicitud:", error);
            alert("Hubo un error al iniciar sesión. Intenta de nuevo.");
        }
    });
</script>



</body>

</html>